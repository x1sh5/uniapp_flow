"use strict";const t=require("../../common/vendor.js");require("../../common/storageKeys.js");const e={data:()=>({id:"",readOnly:!1,formats:{},files:[]}),onLoad(e){this.id=e.id,t.index.loadFontFace({family:"Pacifico",source:'url("../../static/Pacifico.ttf")'})},mounted(){},methods:{backEvent(){t.index.navigateBack()},submitEvent(){this.editorCtx.getContents({success:t=>{console.log(t);let e=t.delta.ops.filter((t=>t.attributes&&"图像"===t.attributes.alt));const o=this.files.filter((t=>e.some((e=>e.attributes["data-local"]===t.path)))),i=getCurrentPages();if(i.length>=2){i[i.length-1].$vm.updateTask(this.id,{ctx:t,files:o})}}}),t.index.navigateBack()},readOnlyChange(){this.readOnly=!this.readOnly},onEditorReady(){t.index.createSelectorQuery().select("#editor").context((t=>{this.editorCtx=t.context,this.editorCtx.setContents(this.$store.state.$currentContent)})).exec()},undo(){this.editorCtx.undo()},redo(){this.editorCtx.redo()},format(t){let{name:e,value:o}=t.target.dataset;e&&this.editorCtx.format(e,o)},onStatusChange(t){const e=t.detail;this.formats=e},insertDivider(){this.editorCtx.insertDivider({success:function(){console.log("insert divider success")}})},clear(){t.index.showModal({title:"清空编辑器",content:"确定清空编辑器全部内容？",success:t=>{t.confirm&&this.editorCtx.clear({success:function(t){console.log("clear success")}})}})},removeFormat(){this.editorCtx.removeFormat()},insertDate(){const t=new Date,e=`${t.getFullYear()}/${t.getMonth()+1}/${t.getDate()}`;this.editorCtx.insertText({text:e})},insertImage(){t.index.chooseImage({count:1,sizeType:["compressed"],success:e=>{console.log(e);let o=e.tempFiles[0];this.files.push(o),o.size>2097152?t.index.showModal({content:"文件大于2Mb"}):this.editorCtx.insertImage({src:e.tempFilePaths[0],alt:"图像",success:function(){console.log("insert image success")}})}})},setTaskContent(){const t=getCurrentPages();if(t.length>=2){t[t.length-2].tasks[this.id].description="new value"}}}};if(!Array){t.resolveComponent("uni-nav-bar")()}Math;const o=t._export_sfc(e,[["render",function(e,o,i,s,a,n){return{a:t.o(n.backEvent),b:t.o(n.submitEvent),c:t.p({"left-icon":"left",leftText:"返回",rightText:"确认",title:"内容编辑",backgroundColor:"#f8f8f8"}),d:t.n(a.formats.bold?"ql-active":""),e:t.n(a.formats.italic?"ql-active":""),f:t.n(a.formats.underline?"ql-active":""),g:t.n(a.formats.strike?"ql-active":""),h:t.n("left"===a.formats.align?"ql-active":""),i:t.n("center"===a.formats.align?"ql-active":""),j:t.n("right"===a.formats.align?"ql-active":""),k:t.n("justify"===a.formats.align?"ql-active":""),l:t.n(a.formats.lineHeight?"ql-active":""),m:t.n(a.formats.letterSpacing?"ql-active":""),n:t.n(a.formats.marginTop?"ql-active":""),o:t.n(a.formats.marginBottom?"ql-active":""),p:t.o(((...t)=>n.removeFormat&&n.removeFormat(...t))),q:t.n(a.formats.fontFamily?"ql-active":""),r:t.n("24px"===a.formats.fontSize?"ql-active":""),s:t.n("#0000ff"===a.formats.color?"ql-active":""),t:t.n("#00ff00"===a.formats.backgroundColor?"ql-active":""),v:t.o(((...t)=>n.insertDate&&n.insertDate(...t))),w:t.n("ordered"===a.formats.list?"ql-active":""),x:t.n("bullet"===a.formats.list?"ql-active":""),y:t.o(((...t)=>n.undo&&n.undo(...t))),z:t.o(((...t)=>n.redo&&n.redo(...t))),A:t.o(((...t)=>n.insertDivider&&n.insertDivider(...t))),B:t.o(((...t)=>n.insertImage&&n.insertImage(...t))),C:t.n(1===a.formats.header?"ql-active":""),D:t.n("sub"===a.formats.script?"ql-active":""),E:t.n("super"===a.formats.script?"ql-active":""),F:t.o(((...t)=>n.clear&&n.clear(...t))),G:t.n("rtl"===a.formats.direction?"ql-active":""),H:t.o(((...t)=>n.format&&n.format(...t))),I:t.o(((...t)=>n.onStatusChange&&n.onStatusChange(...t))),J:a.readOnly,K:t.o(((...t)=>n.onEditorReady&&n.onEditorReady(...t)))}}]]);wx.createPage(o);
