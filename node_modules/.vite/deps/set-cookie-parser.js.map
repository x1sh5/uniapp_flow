{
  "version": 3,
  "sources": ["../../set-cookie-parser/lib/set-cookie.js"],
  "sourcesContent": ["\"use strict\";\r\n\r\nvar defaultParseOptions = {\r\n  decodeValues: true,\r\n  map: false,\r\n  silent: false,\r\n};\r\n\r\nfunction isNonEmptyString(str) {\r\n  return typeof str === \"string\" && !!str.trim();\r\n}\r\n\r\nfunction parseString(setCookieValue, options) {\r\n  var parts = setCookieValue.split(\";\").filter(isNonEmptyString);\r\n\r\n  var nameValuePairStr = parts.shift();\r\n  var parsed = parseNameValuePair(nameValuePairStr);\r\n  var name = parsed.name;\r\n  var value = parsed.value;\r\n\r\n  options = options\r\n    ? Object.assign({}, defaultParseOptions, options)\r\n    : defaultParseOptions;\r\n\r\n  try {\r\n    value = options.decodeValues ? decodeURIComponent(value) : value; // decode cookie value\r\n  } catch (e) {\r\n    console.error(\r\n      \"set-cookie-parser encountered an error while decoding a cookie with value '\" +\r\n        value +\r\n        \"'. Set options.decodeValues to false to disable this feature.\",\r\n      e\r\n    );\r\n  }\r\n\r\n  var cookie = {\r\n    name: name,\r\n    value: value,\r\n  };\r\n\r\n  parts.forEach(function (part) {\r\n    var sides = part.split(\"=\");\r\n    var key = sides.shift().trimLeft().toLowerCase();\r\n    var value = sides.join(\"=\");\r\n    if (key === \"expires\") {\r\n      cookie.expires = new Date(value);\r\n    } else if (key === \"max-age\") {\r\n      cookie.maxAge = parseInt(value, 10);\r\n    } else if (key === \"secure\") {\r\n      cookie.secure = true;\r\n    } else if (key === \"httponly\") {\r\n      cookie.httpOnly = true;\r\n    } else if (key === \"samesite\") {\r\n      cookie.sameSite = value;\r\n    } else {\r\n      cookie[key] = value;\r\n    }\r\n  });\r\n\r\n  return cookie;\r\n}\r\n\r\nfunction parseNameValuePair(nameValuePairStr) {\r\n  // Parses name-value-pair according to rfc6265bis draft\r\n\r\n  var name = \"\";\r\n  var value = \"\";\r\n  var nameValueArr = nameValuePairStr.split(\"=\");\r\n  if (nameValueArr.length > 1) {\r\n    name = nameValueArr.shift();\r\n    value = nameValueArr.join(\"=\"); // everything after the first =, joined by a \"=\" if there was more than one part\r\n  } else {\r\n    value = nameValuePairStr;\r\n  }\r\n\r\n  return { name: name, value: value };\r\n}\r\n\r\nfunction parse(input, options) {\r\n  options = options\r\n    ? Object.assign({}, defaultParseOptions, options)\r\n    : defaultParseOptions;\r\n\r\n  if (!input) {\r\n    if (!options.map) {\r\n      return [];\r\n    } else {\r\n      return {};\r\n    }\r\n  }\r\n\r\n  if (input.headers) {\r\n    if (typeof input.headers.getSetCookie === \"function\") {\r\n      // for fetch responses - they combine headers of the same type in the headers array,\r\n      // but getSetCookie returns an uncombined array\r\n      input = input.headers.getSetCookie();\r\n    } else if (input.headers[\"set-cookie\"]) {\r\n      // fast-path for node.js (which automatically normalizes header names to lower-case\r\n      input = input.headers[\"set-cookie\"];\r\n    } else {\r\n      // slow-path for other environments - see #25\r\n      var sch =\r\n        input.headers[\r\n          Object.keys(input.headers).find(function (key) {\r\n            return key.toLowerCase() === \"set-cookie\";\r\n          })\r\n        ];\r\n      // warn if called on a request-like object with a cookie header rather than a set-cookie header - see #34, 36\r\n      if (!sch && input.headers.cookie && !options.silent) {\r\n        console.warn(\r\n          \"Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning.\"\r\n        );\r\n      }\r\n      input = sch;\r\n    }\r\n  }\r\n  if (!Array.isArray(input)) {\r\n    input = [input];\r\n  }\r\n\r\n  options = options\r\n    ? Object.assign({}, defaultParseOptions, options)\r\n    : defaultParseOptions;\r\n\r\n  if (!options.map) {\r\n    return input.filter(isNonEmptyString).map(function (str) {\r\n      return parseString(str, options);\r\n    });\r\n  } else {\r\n    var cookies = {};\r\n    return input.filter(isNonEmptyString).reduce(function (cookies, str) {\r\n      var cookie = parseString(str, options);\r\n      cookies[cookie.name] = cookie;\r\n      return cookies;\r\n    }, cookies);\r\n  }\r\n}\r\n\r\n/*\r\n  Set-Cookie header field-values are sometimes comma joined in one string. This splits them without choking on commas\r\n  that are within a single set-cookie field-value, such as in the Expires portion.\r\n\r\n  This is uncommon, but explicitly allowed - see https://tools.ietf.org/html/rfc2616#section-4.2\r\n  Node.js does this for every header *except* set-cookie - see https://github.com/nodejs/node/blob/d5e363b77ebaf1caf67cd7528224b651c86815c1/lib/_http_incoming.js#L128\r\n  React Native's fetch does this for *every* header, including set-cookie.\r\n\r\n  Based on: https://github.com/google/j2objc/commit/16820fdbc8f76ca0c33472810ce0cb03d20efe25\r\n  Credits to: https://github.com/tomball for original and https://github.com/chrusart for JavaScript implementation\r\n*/\r\nfunction splitCookiesString(cookiesString) {\r\n  if (Array.isArray(cookiesString)) {\r\n    return cookiesString;\r\n  }\r\n  if (typeof cookiesString !== \"string\") {\r\n    return [];\r\n  }\r\n\r\n  var cookiesStrings = [];\r\n  var pos = 0;\r\n  var start;\r\n  var ch;\r\n  var lastComma;\r\n  var nextStart;\r\n  var cookiesSeparatorFound;\r\n\r\n  function skipWhitespace() {\r\n    while (pos < cookiesString.length && /\\s/.test(cookiesString.charAt(pos))) {\r\n      pos += 1;\r\n    }\r\n    return pos < cookiesString.length;\r\n  }\r\n\r\n  function notSpecialChar() {\r\n    ch = cookiesString.charAt(pos);\r\n\r\n    return ch !== \"=\" && ch !== \";\" && ch !== \",\";\r\n  }\r\n\r\n  while (pos < cookiesString.length) {\r\n    start = pos;\r\n    cookiesSeparatorFound = false;\r\n\r\n    while (skipWhitespace()) {\r\n      ch = cookiesString.charAt(pos);\r\n      if (ch === \",\") {\r\n        // ',' is a cookie separator if we have later first '=', not ';' or ','\r\n        lastComma = pos;\r\n        pos += 1;\r\n\r\n        skipWhitespace();\r\n        nextStart = pos;\r\n\r\n        while (pos < cookiesString.length && notSpecialChar()) {\r\n          pos += 1;\r\n        }\r\n\r\n        // currently special character\r\n        if (pos < cookiesString.length && cookiesString.charAt(pos) === \"=\") {\r\n          // we found cookies separator\r\n          cookiesSeparatorFound = true;\r\n          // pos is inside the next cookie, so back up and return it.\r\n          pos = nextStart;\r\n          cookiesStrings.push(cookiesString.substring(start, lastComma));\r\n          start = pos;\r\n        } else {\r\n          // in param ',' or param separator ';',\r\n          // we continue from that comma\r\n          pos = lastComma + 1;\r\n        }\r\n      } else {\r\n        pos += 1;\r\n      }\r\n    }\r\n\r\n    if (!cookiesSeparatorFound || pos >= cookiesString.length) {\r\n      cookiesStrings.push(cookiesString.substring(start, cookiesString.length));\r\n    }\r\n  }\r\n\r\n  return cookiesStrings;\r\n}\r\n\r\nmodule.exports = parse;\r\nmodule.exports.parse = parse;\r\nmodule.exports.parseString = parseString;\r\nmodule.exports.splitCookiesString = splitCookiesString;\r\n"],
  "mappings": "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",
  "names": ["value", "cookies"]
}
