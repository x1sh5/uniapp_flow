"use strict";const t=require("../../common/vendor.js"),e={data:()=>({$enable:!1,ptask:void 0,ctasks:void 0,mode:{type:String,default:()=>"done"},status:["waitfor","undone","done","announcement"]}),created(){console.log("created")},computed:{enable(){return this.$data.$enable},html:{get(){return this.task.description}}},mounted(){console.log("mounted");let e=this.$store.state.apiBaseUrl+"/api/Assignment/childs/"+this.task.id,s=this.$store.state.apiBaseUrl+"/api/Assignment/parent/"+this.task.id;this.ptask||t.index.request({url:e,success:t=>{200===t.statusCode&&(this.ctasks=t.data)}}),this.ctasks||t.index.request({url:s,success:t=>{200===t.statusCode&&(this.ptask=t.data)}})},onLoad(e){console.log("options:",e),this.id=e.id;let s=this.$store.getters.getTaskById(this.id);if(void 0!==s)this.task=s;else{let e=this.$store.state.apiBaseUrl+"/api/Assignment/"+this.id;t.index.requestWithCookie({url:e,success:t=>{200==t.statusCode&&(this.task=t.data)}})}this.mode=this.status[this.task.status]},methods:{editEvent(e){t.index.navigateTo({url:"/pages/editor/editor"})},contact(e){t.index.navigateTo({url:"/pages/chat/chat?cid="+this.task.id+"&userName="+this.task.username+"&userId="+this.task.userId})},gain(e){let s=this.$store.state.apiBaseUrl+"/api/TaskRequest";t.index.showModal({editable:!0,title:"输入留言。",placeholderText:"输入留言。",success:e=>{e.confirm&&t.index.requestWithCookie({url:s,method:"POST",data:{id:0,userId:0,title:this.task.title,branchid:this.task.branchid,taskId:this.task.id,agree:2,requestDate:new Date,agreeDate:new Date,comment:e.content},success:e=>{t.index.showModal({content:e.data,showCancel:!1})},fail:e=>{t.index.showModal({content:e})}})}})},abandon(e){let s=this.$store.state.apiBaseUrl+"/api/AssignmentUser/abandon/"+this.task.id;t.index.requestWithCookie({url:s,method:"DELETE",success:e=>{204!==e.statusCode?t.index.showModal({content:"网络出错"}):t.index.showModal({content:"已放弃该任务。"}),this.$data.$enable=!0,this.$store.commit("updateTaskById",this.task.id)}})},reloadTask(e){console.log(e.id),this.$store.commit("setCurrentTask",e),t.index.redirectTo({url:"/pages/taskDetail/taskDetail?id="+e.id})}}};if(!Array){(t.resolveComponent("taskCard")+t.resolveComponent("cardinfo"))()}Math||((()=>"../../components/taskCard/taskCard.js")+(()=>"../../components/cardinfo/cardinfo.js"))();const s=t._export_sfc(e,[["render",function(e,s,a,i,o,d){return t.e({a:t.p({task:e.task,editable:!1}),b:"waitfor"==o.mode},"waitfor"==o.mode?{c:t.o(((...t)=>d.contact&&d.contact(...t))),d:t.o(((...t)=>d.gain&&d.gain(...t)))}:{},{e:"undone"==o.mode},"undone"==o.mode?{f:t.o(((...t)=>d.contact&&d.contact(...t))),g:t.o(((...t)=>d.abandon&&d.abandon(...t))),h:d.enable}:{},{i:o.ptask},o.ptask?{j:t.o((t=>d.reloadTask(o.ptask))),k:t.p({task:o.ptask,editable:!1})}:{},{l:o.ctasks},o.ctasks?{m:t.f(o.ctasks,((e,s,a)=>({a:t.o((t=>d.reloadTask(e)),e.id),b:"83597234-2-"+a,c:t.p({task:e,editable:!1}),d:e.id})))}:{})}]]);wx.createPage(s);
