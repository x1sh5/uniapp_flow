"use strict";const e=require("../../../common/vendor.js");function t(e){if(null===e||"object"!=typeof e)return e;if(Array.isArray(e)){const r=[];for(let o=0;o<e.length;o++)r[o]=t(e[o]);return r}const r={};for(let o in e)e.hasOwnProperty(o)&&(r[o]=t(e[o]));return r}const r={data:()=>({refer:{},dataLoaded:!1}),computed:{lines(){let e=[];for(let t of Array.from(this.refer.content.keys()))e.push({id:t});return e}},methods:{commit(t){if(""===this.refer.title)return void e.index.showToast({title:"标题不能为空。"});if(0===this.lines.length)return void e.index.showToast({title:"内容不能为空。"});if(_.isEqual(this.refer,this.old))return void e.index.showToast({title:"内容未做改变。"});let r=JSON.stringify(Array.from(this.refer.content)),o=this.$store.state.apiBaseUrl+"/api/Reference/"+this.refer.id;e.index.requestWithCookie({url:o,method:"PUT",data:{...this.refer,content:r},success:t=>{e.index.showModal({showCancel:!1,content:t.data,success(t){t.confirm&&e.index.navigateBack()}})}})}},onLoad(r){let o;console.log("onload"),this.id=r.id;let i=this.$store.getters["Refer/getReferById"](this.id);if(!(i.content instanceof Map)){o=JSON.parse(i.content);let e=new Map;if("function"==typeof o[Symbol.iterator])for(let t of o)Array.isArray(t)&&2===t.length&&e.set(t[0],t[1]);i.content=e}this.refer=i,this.old=t(e.markRaw(i)),this.dataLoaded=!0}};if(!Array){e.resolveComponent("refer")()}Math;const o=e._export_sfc(r,[["render",function(t,r,o,i,n,s){return{a:e.p({refer:n.refer,editable:!0}),b:e.o(((...e)=>s.commit&&s.commit(...e)))}}]]);wx.createPage(o);
